<div class="container">

<table style="width: 100%;"><tr>
<td>plot.qrtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile residual tests for GMAR, StMAR , and G-StMAR models</h2>

<h3>Description</h3>

<p><code>quantile_residual_tests</code> performs quantile residual tests for GMAR, StMAR,
and G-StMAR models, testing normality, autocorrelation, and conditional heteroscedasticity
of the quantile residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'qrtest'
plot(x, ...)

## S3 method for class 'qrtest'
print(x, ..., digits = 3)

quantile_residual_tests(
  gsmar,
  lags_ac = c(1, 3, 6, 12),
  lags_ch = lags_ac,
  nsimu = 1,
  print_res = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>'qrtest'</code> created with the function <code>quantile_residual_tests</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters passed to <code>segments</code> in <code>plot.qrtest</code>.
Currently not used in <code>print.qrtest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits to be print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsmar</code></td>
<td>
<p>a class 'gsmar' object, typically generated by <code>fitGSMAR</code> or <code>GSMAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags_ac</code></td>
<td>
<p>a numeric vector of positive integers specifying the lags for which autocorrelation is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags_ch</code></td>
<td>
<p>a numeric vector of positive integers specifying the lags for which conditional heteroscedasticity
is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsimu</code></td>
<td>
<p>a positive integer specifying to how many simulated observations the covariance matrix Omega
(see Kalliovirta (2012)) should be based on. If smaller than data size, then omega will be based on the
given data and not on simulated data. Having the covariance matrix omega based on a large simulated sample
might improve the tests size properties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_res</code></td>
<td>
<p>a logical argument defining whether the results should be printed or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a correctly specified GSMAR model employing the maximum likelihood estimator, the quantile residuals
are asymptotically independent with standard normal distribution. They can hence be used in a similar
manner to conventional Pearson's residuals. For more details about quantile residual based diagnostics,
and in particular, about the quantile residual tests, see the cited article by <em>Kalliovirta (2012)</em>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'qrtest'</code> containing the test results in data frames. In the cases
of autocorrelation and conditional heteroscedasticity tests, the returned object also contains the
associated individual statistics and their standard errors, discussed in <em>Kalliovirta (2012)</em> at
the pages 369-370.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>plot(qrtest)</code>: Plot p-values of the autocorrelation and conditional
heteroskedasticity tests.
</p>
</li>
<li> <p><code>print(qrtest)</code>: Print method for class 'qrtest' objects
</p>
</li>
</ul>
<h3>References</h3>


<ul>
<li>
<p> Galbraith, R., Galbraith, J. 1974. On the inverses of some patterned matrices arising
in the theory of stationary time series. <em>Journal of Applied Probability</em> <strong>11</strong>, 63-71.
</p>
</li>
<li>
<p> Kalliovirta L. (2012) Misspecification tests based on quantile residuals.
<em>The Econometrics Journal</em>, <strong>15</strong>, 358-393.
</p>
</li>
<li>
<p> Kalliovirta L., Meitz M. and Saikkonen P. 2015. Gaussian Mixture Autoregressive model for univariate time series.
<em>Journal of Time Series Analysis</em>, <strong>36</strong>(2), 247-266.
</p>
</li>
<li>
<p> Meitz M., Preve D., Saikkonen P. 2023. A mixture autoregressive model based on Student's t-distribution.
<em>Communications in Statistics - Theory and Methods</em>, <strong>52</strong>(2), 499-515.
</p>
</li>
<li>
<p> Virolainen S. 2022. A mixture autoregressive model based on Gaussian and Student's t-distributions.
Studies in Nonlinear Dynamics &amp; Econometrics, <strong>26</strong>(4) 559-580.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>profile_logliks</code>, <code>fitGSMAR</code>, <code>GSMAR</code>, <code>diagnostic_plot</code>,
<code>predict.gsmar</code>, <code>get_test_Omega</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The below examples take approximately 30 seconds to run.

# G-StMAR model with one GMAR type and one StMAR type regime
fit42gs &lt;- fitGSMAR(data=M10Y1Y, p=4, M=c(1, 1), model="G-StMAR",
                    ncalls=1, seeds=4)

# Tests based on the observed data (without simulation procedure) with the
# default lags:
qrt1 &lt;- quantile_residual_tests(fit42gs)

# Tests based on the simulation procedure using sample size 10000 and with
# the lags specified by hand:
set.seed(1)
qrt2 &lt;- quantile_residual_tests(fit42gs, lags_ac=c(1, 6), nsimu=10000)

# GMAR model
fit12 &lt;- fitGSMAR(data=simudata, p=1, M=2, model="GMAR", ncalls=1, seeds=1)
qrt3 &lt;- quantile_residual_tests(fit12, lags_ac=c(1, 5, 10, 15))

</code></pre>


</div>