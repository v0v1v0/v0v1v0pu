<div class="container">

<table style="width: 100%;"><tr>
<td>xmu_twin_add_WeightMatrices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add weight matrices to twin models.</h2>

<h3>Description</h3>

<p>Add weight models (MZw, DZw) with matrices (e.g. mzWeightMatrix) to a twin model, and
update <code>mxFitFunctionMultigroup</code>. This yields a weighted model with vector objective.
</p>
<p>To weight objective functions in OpenMx, you specify a container model that applies the weights
m1 is the model with no weights, but with "vector = TRUE" option added to the FIML objective.
This option makes FIML return individual likelihoods for each row of the data (rather than a single
-2LL value for the model)
You then optimize weighted versions of these likelihoods by building additional models containing
weight data and an algebra that multiplies the likelihoods from the first model by the weight vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xmu_twin_add_WeightMatrices(model, mzWeights = NULL, dzWeights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>umx-style twin model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mzWeights</code></td>
<td>
<p>data for MZ weights matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzWeights</code></td>
<td>
<p>data for DZ weights matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul><li>
<p> model
</p>
</li></ul>
<h3>See Also</h3>

<p>Other xmu internal not for end user: 
<code>umxModel()</code>,
<code>umxRenameMatrix()</code>,
<code>umx_APA_pval()</code>,
<code>umx_fun_mean_sd()</code>,
<code>umx_get_bracket_addresses()</code>,
<code>umx_make()</code>,
<code>umx_standardize()</code>,
<code>umx_string_to_algebra()</code>,
<code>xmuHasSquareBrackets()</code>,
<code>xmuLabel_MATRIX_Model()</code>,
<code>xmuLabel_Matrix()</code>,
<code>xmuLabel_RAM_Model()</code>,
<code>xmuMI()</code>,
<code>xmuMakeDeviationThresholdsMatrices()</code>,
<code>xmuMakeOneHeadedPathsFromPathList()</code>,
<code>xmuMakeTwoHeadedPathsFromPathList()</code>,
<code>xmuMaxLevels()</code>,
<code>xmuMinLevels()</code>,
<code>xmuPropagateLabels()</code>,
<code>xmuRAM2Ordinal()</code>,
<code>xmuTwinSuper_Continuous()</code>,
<code>xmuTwinSuper_NoBinary()</code>,
<code>xmuTwinUpgradeMeansToCovariateModel()</code>,
<code>xmu_CI_merge()</code>,
<code>xmu_CI_stash()</code>,
<code>xmu_DF_to_mxData_TypeCov()</code>,
<code>xmu_PadAndPruneForDefVars()</code>,
<code>xmu_bracket_address2rclabel()</code>,
<code>xmu_cell_is_on()</code>,
<code>xmu_check_levels_identical()</code>,
<code>xmu_check_needs_means()</code>,
<code>xmu_check_variance()</code>,
<code>xmu_clean_label()</code>,
<code>xmu_data_missing()</code>,
<code>xmu_data_swap_a_block()</code>,
<code>xmu_describe_data_WLS()</code>,
<code>xmu_dot_make_paths()</code>,
<code>xmu_dot_make_residuals()</code>,
<code>xmu_dot_maker()</code>,
<code>xmu_dot_move_ranks()</code>,
<code>xmu_dot_rank_str()</code>,
<code>xmu_extract_column()</code>,
<code>xmu_get_CI()</code>,
<code>xmu_lavaan_process_group()</code>,
<code>xmu_make_TwinSuperModel()</code>,
<code>xmu_make_bin_cont_pair_data()</code>,
<code>xmu_make_mxData()</code>,
<code>xmu_match.arg()</code>,
<code>xmu_name_from_lavaan_str()</code>,
<code>xmu_path2twin()</code>,
<code>xmu_path_regex()</code>,
<code>xmu_print_algebras()</code>,
<code>xmu_rclabel_2_bracket_address()</code>,
<code>xmu_safe_run_summary()</code>,
<code>xmu_set_sep_from_suffix()</code>,
<code>xmu_show_fit_or_comparison()</code>,
<code>xmu_simplex_corner()</code>,
<code>xmu_standardize_ACEcov()</code>,
<code>xmu_standardize_ACEv()</code>,
<code>xmu_standardize_ACE()</code>,
<code>xmu_standardize_CP()</code>,
<code>xmu_standardize_IP()</code>,
<code>xmu_standardize_RAM()</code>,
<code>xmu_standardize_SexLim()</code>,
<code>xmu_standardize_Simplex()</code>,
<code>xmu_start_value_list()</code>,
<code>xmu_starts()</code>,
<code>xmu_summary_RAM_group_parameters()</code>,
<code>xmu_twin_check()</code>,
<code>xmu_twin_get_var_names()</code>,
<code>xmu_twin_make_def_means_mats_and_alg()</code>,
<code>xmu_twin_upgrade_selDvs2SelVars()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tmp = umx_make_twin_data_nice(data=twinData, sep="", zygosity="zygosity", numbering= 1:2)
m1  = umxACE(selDVs = "wt", data = tmp, dzData = "DZFF", mzData = "MZFF", autoRun= FALSE)
m1$MZ$fitfunction$vector= TRUE

tmp = xmu_twin_add_WeightMatrices(m1,
	mzWeights= rnorm(nrow(m1$MZ$data$observed)), 
	dzWeights= rnorm(nrow(m1$DZ$data$observed))
)

</code></pre>


</div>