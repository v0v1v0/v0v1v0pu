<div class="container">

<table style="width: 100%;"><tr>
<td>evaluate_sample_k</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate sample k</h2>

<h3>Description</h3>

<p>This functions calculates three indices (Davies-Bouldin, Calinsky-Harabasz and average Silhouette score) for each k.
Calculations are made for a single sample and for a default range of k that goes from 3 to 10.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evaluate_sample_k(
  data,
  sample_id,
  samples_col = "Sample",
  abundance_col = "Abundance",
  range = 3:10,
  with_plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame with, at least, the classification, abundance and sample information for each phylogenetic unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_id</code></td>
<td>
<p>String with name of the sample to apply this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples_col</code></td>
<td>
<p>String with name of column with sample names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance_col</code></td>
<td>
<p>string with name of column with abundance values. Default is "Abundance".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>The range of values of k to test, default is from 3 to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with_plot</code></td>
<td>
<p>If FALSE (default) returns a vector, but if TRUE will return a plot with the scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Note</strong>: To get the indices for all samples, use <code>evaluate_k()</code> instead.
</p>
<p><strong>Data input</strong>
</p>
<p>This function takes a data.frame with a column for samples and a column for abundance
(minimum), but can take any number of other columns. It will then filter the specific sample
that you want to analyze. You can also pre-filter for your specific sample, but you still need to
provide the sample ID (sample_id) and the table always needs a column for Sample and another for Abundance
(indicate how you name them with the arguments samples_col and abundance_col).
</p>
<p><strong>Output options</strong>
</p>
<p>The default option returns a data.frame with Davies-Bouldin, Calinsky-Harabasz and
average Silhouette scores for each k. This is a simple output that can then be used
for other analysis. However, we also provide the option to show a plot (set <code>with_plot = TRUE</code>).
</p>
<p><strong>Three indices are calculated by this function:</strong>
</p>

<ul>
<li>
<p> Davies-Bouldin with <code>check_DB()</code>;
</p>
</li>
<li>
<p> Calinsky-Harabasz with <code>check_DB()</code>;
</p>
</li>
<li>
<p> average Silhouette score <code>check_avgSil()</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A data.frame (or plot) with several indices for each number of clusters.
</p>


<h3>See Also</h3>

<p><code>check_CH()</code>, <code>check_DB()</code>, <code>check_avgSil()</code>, <code>suggest_k()</code>, <code>evaluate_k()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
#
evaluate_sample_k(nice_tidy, sample_id = "ERR2044662")

# To change range
evaluate_sample_k(nice_tidy, sample_id = "ERR2044662", range = 4:11)

# To make simple plot
evaluate_sample_k(nice_tidy, sample_id = "ERR2044662", range = 4:11, with_plot =TRUE)

</code></pre>


</div>