<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ulrb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ulrb clustering results and silhouette scores</h2>

<h3>Description</h3>

<p>Function to help access clustering results from ulrb.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ulrb(
  data,
  sample_id = NULL,
  taxa_col,
  plot_all = FALSE,
  silhouette_score = "Silhouette_scores",
  classification_col = "Classification",
  abundance_col = "Abundance",
  log_scaled = FALSE,
  colors = c("#009E73", "#F0E442", "#CC79A7"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame with, at least, the classification, abundance and sample information for each phylogenetic unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_id</code></td>
<td>
<p>string with name of selected sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_col</code></td>
<td>
<p>string with name of column with phylogenetic units. Usually OTU or ASV.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_all</code></td>
<td>
<p>If TRUE, will make a plot for all samples with mean and standard deviation. If FALSE (default), then the plot will illustrate a single sample, that you have to specifiy in sample_id argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silhouette_score</code></td>
<td>
<p>string with column name with silhouette score values. Default is "Silhouette_scores"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classification_col</code></td>
<td>
<p>string with name of column with classification for each row. Default value is "Classification".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance_col</code></td>
<td>
<p>string with name of column with abundance values. Default is "Abundance".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_scaled</code></td>
<td>
<p>if TRUE then abundance scores will be shown in Log10 scale. Default to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>vector with colors. Should have the same lenght as the number of classifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function combined <code>plot_ulrb_clustering()</code> and <code>plot_ulrb_silhouette()</code>.
The plots can be done for a single sample or for all samples.
</p>
<p>The results from the main function of ulrb package, <code>define_rb()</code>, will include the classification of
each species (OTU, ASVs, etc) and the silhouette score obtained for each observation. Thus, to access the clustering results, there are two main plots to check:
</p>

<ul>
<li>
<p> the rank abundance curve obtained after ulrb classification;
</p>
</li>
<li>
<p> and the silhouette plot.
</p>
</li>
</ul>
<p><strong>Interpretation of Silhouette plot</strong>
</p>
<p>Based on chapter 2 of "Finding Groups in Data: An Introduction to Cluster Analysis."
(Kaufman and Rousseeuw, 1991); a possible (<strong>subjective</strong>) interpretation of the clustering structure based
on the Silhouette plot is:
</p>

<ul>
<li>
<p> 0.71-1.00 (A strong structure has been found);
</p>
</li>
<li>
<p> 0.51-0.70 (A reasonable structure has been found);
</p>
</li>
<li>
<p> 0.26-0.50 (The structure is weak and could be artificial);
</p>
</li>
<li>
<p> &lt;0.26 (No structure has been found).
</p>
</li>
</ul>
<h3>Value</h3>

<p>A grid of ggplot objects with clustering results and
silhouette plot obtained from <code>define_rb()</code>.
</p>


<h3>See Also</h3>

<p><code>define_rb()</code>, <code>check_avgSil()</code>, <code>plot_ulrb_clustering()</code>, <code>plot_ulrb_silhouette()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
classified_species &lt;- define_rb(nice_tidy)

# Default parameters for a single sample ERR2044669
plot_ulrb(classified_species,
          sample_id = "ERR2044669",
          taxa_col = "OTU",
          abundance_col = "Abundance")

# All samples in a dataset
plot_ulrb(classified_species,
          taxa_col = "OTU",
          abundance_col = "Abundance",
          plot_all = TRUE)

# All samples with a log scale
plot_ulrb(classified_species,
          taxa_col = "OTU",
          abundance_col = "Abundance",
          plot_all = TRUE,
          log_scaled = TRUE)

</code></pre>


</div>