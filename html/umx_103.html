<div class="container">

<table style="width: 100%;"><tr>
<td>umxGxE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>umxGxE: Implements ACE models with moderation of paths, e.g. by SES.</h2>

<h3>Description</h3>

<p>Make a 2-group GxE (moderated ACE) model (Purcell, 2002). GxE interaction studies test the hypothesis that the strength
of genetic (or environmental) influence varies parametrically (usually linear effects on path estimates)
across levels of environment. umxGxE allows detecting,
testing, and visualizing  G xE (or C or E x E) interaction forms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">umxGxE(
  name = "G_by_E",
  selDVs,
  selDefs,
  dzData,
  mzData,
  sep = NULL,
  data = NULL,
  zyg = "zygosity",
  digits = 3,
  lboundACE = NA,
  lboundM = NA,
  dropMissingDef = TRUE,
  dzAr = 0.5,
  dzCr = 1,
  autoRun = getOption("umx_auto_run"),
  tryHard = c("no", "yes", "ordinal", "search"),
  optimizer = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the model (default= "G_by_E")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selDVs</code></td>
<td>
<p>The dependent variable (e.g. "IQ")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selDefs</code></td>
<td>
<p>The definition variable (e.g. "SES")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzData</code></td>
<td>
<p>The DZ dataframe containing the Twin 1 and Twin 2 DV and moderator (4 columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mzData</code></td>
<td>
<p>The MZ dataframe containing the Twin 1 and Twin 2 DV and moderator (4 columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>How to expand selDVs into full names, i.e., "_T" makes "var" -&gt; "var_T1" and "var_T2"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If provided, dzData and mzData are treated as valid levels of zyg to select() data sets (default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zyg</code></td>
<td>
<p>If data provided, this column is used to select rows by zygosity (Default = "zygosity")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Rounding precision for tables (default 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lboundACE</code></td>
<td>
<p>If not NA, then lbound the main effects at this value (default = NA, can help to set this to 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lboundM</code></td>
<td>
<p>If not NA, then lbound the moderator effects at this value (default = NA, can help to set this to 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropMissingDef</code></td>
<td>
<p>Whether to automatically drop missing def var rows for the user (default = TRUE). You get a polite note.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzAr</code></td>
<td>
<p>The DZ genetic correlation (defaults to .5, vary to examine assortative mating).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzCr</code></td>
<td>
<p>The DZ "C" correlation (defaults to 1: set to .25 to make an ADE model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoRun</code></td>
<td>
<p>Optionally run the model (default), or just to create it and return without running.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tryHard</code></td>
<td>
<p>Optionally tryHard to get the model to converge (Default = 'no'). "yes" uses mxTryHard. Other options: "ordinal", "search".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>Optionally set the optimizer (default NULL does nothing)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following figure the GxE model as a path diagram:
</p>
<p><img src="../help/figures/GxE.png" width="50%" alt="Figure: GxE.png"></p>


<h3>Value</h3>


<ul><li>
<p> GxE <code>mxModel()</code>
</p>
</li></ul>
<h3>References</h3>


<ul><li>
<p> Purcell, S. (2002). Variance components models for gene-environment interaction in twin analysis. <em>Twin Research</em>,
<strong>6</strong>, 554-571. <a href="https://doi.org/10.1375/twin.5.6.554">doi:10.1375/twin.5.6.554</a>
</p>
</li></ul>
<h3>See Also</h3>

<p><code>umxGxE_window()</code>, <code>umxReduce()</code>, <code>umxSummary()</code>
</p>
<p>Other Twin Modeling Functions: 
<code>power.ACE.test()</code>,
<code>umxACEcov()</code>,
<code>umxACEv()</code>,
<code>umxACE()</code>,
<code>umxCP()</code>,
<code>umxDiffMZ()</code>,
<code>umxDiscTwin()</code>,
<code>umxDoCp()</code>,
<code>umxDoC()</code>,
<code>umxGxE_window()</code>,
<code>umxGxEbiv()</code>,
<code>umxIP()</code>,
<code>umxMRDoC()</code>,
<code>umxReduceACE()</code>,
<code>umxReduceGxE()</code>,
<code>umxReduce()</code>,
<code>umxRotate.MxModelCP()</code>,
<code>umxSexLim()</code>,
<code>umxSimplex()</code>,
<code>umxSummarizeTwinData()</code>,
<code>umxSummaryACEv()</code>,
<code>umxSummaryACE()</code>,
<code>umxSummaryDoC()</code>,
<code>umxSummaryGxEbiv()</code>,
<code>umxSummarySexLim()</code>,
<code>umxSummarySimplex()</code>,
<code>umxTwinMaker()</code>,
<code>umx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
require(umx)
data(twinData) 
twinData$age1 = twinData$age2 = twinData$age
selDVs  = "bmi"
selDefs = "age"
mzData  = subset(twinData, zygosity == "MZFF")[1:100,]
dzData  = subset(twinData, zygosity == "DZFF")[1:100,]
m1 = umxGxE(selDVs= "bmi", selDefs= "age", sep= "", dzData= dzData, mzData= mzData, tryHard= "yes")

# Select the data on the fly with data= and zygosity levels
m1 = umxGxE(selDVs= "bmi", selDefs= "age", sep="", dzData= "DZFF", mzData= "MZFF", data= twinData)

# ===============================================================
# = example with Twins having different values of the moderator =
# ===============================================================

twinData$age1 = twinData$age2 = twinData$age
tmp = twinData
tmp$age2 = tmp$age2 +rnorm(n=length(tmp$age2))
selDVs  = "bmi"
selDefs = "age"
mzData = subset(tmp, zygosity == "MZFF")
dzData = subset(tmp, zygosity == "DZFF")
m1 = umxGxE(selDVs= "bmi", selDefs= "age", sep= "", dzData= dzData, mzData= mzData, tryHard= "yes")

# ====================================
# = Controlling output of umxSummary =
# ====================================
umxSummaryGxE(m1)
umxSummary(m1, location = "topright")
umxSummary(m1, separateGraphs = TRUE)

m2 = umxModify(m1, regex = "am_.*", comparison = TRUE, tryHard = "yes")

# umxReduce knows how to test all relevant hypotheses for GxE models,
# reporting these in a nice table.
umxReduce(m1)

## End(Not run)
</code></pre>


</div>