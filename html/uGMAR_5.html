<div class="container">

<table style="width: 100%;"><tr>
<td>alt_gsmar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct a GSMAR model based on results from an arbitrary estimation round of <code>fitGSMAR</code>
</h2>

<h3>Description</h3>

<p><code>alt_gsmar</code> constructs a GSMAR model based on results from an arbitrary estimation round of <code>fitGSMAR</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">alt_gsmar(
  gsmar,
  which_round = 1,
  which_largest,
  calc_qresiduals = TRUE,
  calc_cond_moments = TRUE,
  calc_std_errors = TRUE,
  custom_h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gsmar</code></td>
<td>
<p>a class 'gsmar' object, typically generated by <code>fitGSMAR</code> or <code>GSMAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_round</code></td>
<td>
<p>based on which estimation round should the model be constructed? An integer value in 1,...,<code>ncalls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_largest</code></td>
<td>
<p>based on estimation round with which largest log-likelihood should the model be constructed?
An integer value in 1,...,<code>ncalls</code>. For example, <code>which_largest=2</code> would take the second largest log-likelihood
and construct the model based on the corresponding estimates. If specified, then <code>which_round</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_qresiduals</code></td>
<td>
<p>should quantile residuals be calculated? Default is <code>TRUE</code> iff the model contains data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_cond_moments</code></td>
<td>
<p>should conditional means and variances be calculated? Default is <code>TRUE</code> iff the model contains data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_std_errors</code></td>
<td>
<p>should approximate standard errors be calculated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_h</code></td>
<td>
<p>A numeric vector with same the length as the parameter vector: i:th element of custom_h is the difference
used in central difference approximation for partial differentials of the log-likelihood function for the i:th parameter.
If <code>NULL</code> (default), then the difference used for differentiating overly large degrees of freedom parameters
is adjusted to avoid numerical problems, and the difference is <code>6e-6</code> for the other parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It's sometimes useful to examine other estimates than the one with the highest log-likelihood value. This function
is just a simple wrapper to <code>GSMAR</code> that picks the correct estimates from an object returned by <code>fitGSMAR</code>.
</p>
<p>In addition to the S3 methods listed under the topic "Methods (by generic)", the <code>predict</code> and <code>simulate</code> methods
are also available for the class 'gsmar' objects (see <code>?predict.gsmar</code> and <code>?simulate.gsmar</code>).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'gsmar'</code> defining the specified GMAR, StMAR, or G-StMAR model. If data is supplied,
the returned object contains (by default) empirical mixing weights, some conditional and unconditional moments, and quantile
residuals. Note that the first p observations are taken as the initial values so the mixing weights, conditional moments, and
quantile residuals start from the p+1:th observation (interpreted as t=1).
</p>


<h3>References</h3>


<ul>
<li>
<p> Kalliovirta L., Meitz M. and Saikkonen P. 2015. Gaussian Mixture Autoregressive model for univariate time series.
<em>Journal of Time Series Analysis</em>, <strong>36</strong>(2), 247-266.
</p>
</li>
<li>
<p> Meitz M., Preve D., Saikkonen P. 2023. A mixture autoregressive model based on Student's t-distribution.
<em>Communications in Statistics - Theory and Methods</em>, <strong>52</strong>(2), 499-515.
</p>
</li>
<li>
<p> Virolainen S. 2022. A mixture autoregressive model based on Gaussian and Student's t-distributions.
Studies in Nonlinear Dynamics &amp; Econometrics, <strong>26</strong>(4) 559-580.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fitGSMAR</code>, <code>GSMAR</code>, <code>iterate_more</code>, <code>get_gradient</code>,
<code>get_regime_means</code>, <code>swap_parametrization</code>, <code>stmar_to_gstmar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # These are long running examples that take approximately ...
 fit42t &lt;- fitGSMAR(data=M10Y1Y, p=4, M=2, model="StMAR", ncalls=2,
                    seeds=c(1, 6))
 fit42t # Bad estimate in the boundary of the stationarity region!

 # So we build a model based on the next-best local maximum point:
 fit42t_alt &lt;- alt_gsmar(fit42t, which_largest=2)
 fit42t_alt # Overly large degrees of freedom paramter estimate

 # Switch to the appropriate G-StMAR model:
 fit42gs &lt;- stmar_to_gstmar(fit42t_alt)
 fit42gs

</code></pre>


</div>