<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ulrb_silhouette</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot silhouette scores from clustering results</h2>

<h3>Description</h3>

<p>Plots the Silhouette scores from the clustering results of <code>define_rb()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ulrb_silhouette(
  data,
  sample_id = NULL,
  taxa_col,
  samples_col = "Sample",
  plot_all = FALSE,
  classification_col = "Classification",
  silhouette_score = "Silhouette_scores",
  colors = c("#009E73", "#F0E442", "#CC79A7"),
  log_scaled = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_id</code></td>
<td>
<p>string with name of selected sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_col</code></td>
<td>
<p>string with name of column with phylogenetic units. Usually OTU or ASV.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples_col</code></td>
<td>
<p>name of column with sample ID's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_all</code></td>
<td>
<p>If TRUE, will make a plot for all samples with mean and standard deviation. If FALSE (default), then the plot will illustrate a single sample, that you have to specifiy in sample_id argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classification_col</code></td>
<td>
<p>string with name of column with classification for each row. Default value is "Classification".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silhouette_score</code></td>
<td>
<p>string with column name with silhouette score values. Default is "Silhouette_scores"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>vector with colors. Should have the same lenght as the number of classifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_scaled</code></td>
<td>
<p>if TRUE then abundance scores will be shown in Log10 scale. Default to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This works as a sanity check of the results obtained by the unsupervised learning method used
to classify species. This is specially important if you used an automatic number of clusters.
</p>
<p>The function works for either a single sample (that you specify with sample_id argument), or
it can apply a centrality metric for species across all your samples (plot_all = TRUE).
</p>
<p>For more details on Silhouette score, see <code>check_avgSil()</code> and <code>cluster::silhouette()</code>.
</p>
<p><strong>Interpretation of Silhouette plot</strong>
</p>
<p>Based on chapter 2 of "Finding Groups in Data: An Introduction to Cluster Analysis."
(Kaufman and Rousseeuw, 1991); a possible (<strong>subjective</strong>) interpretation of the clustering structure based
on the Silhouette plot is:
</p>

<ul>
<li>
<p> 0.71-1.00 (A strong structure has been found);
</p>
</li>
<li>
<p> 0.51-0.70 (A reasonable structure has been found);
</p>
</li>
<li>
<p> 0.26-0.50 (The structure is weak and could be artificial);
</p>
</li>
<li>
<p> &lt; 0.26 (No structure has been found).
</p>
</li>
</ul>
<h3>Value</h3>

<p>A ggplot object of Silhouette plot obtained from the selected sample.
</p>


<h3>See Also</h3>

<p><code>define_rb()</code>, <code>check_avgSil()</code>, <code>plot_ulrb_clustering()</code>,
<code>plot_ulrb()</code>, <code>cluster::silhouette()</code>, <code>cluster::pam()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
classified_species &lt;- define_rb(nice_tidy)

# Standard plot for a single sample
plot_ulrb_silhouette(classified_species,
                       sample_id = "ERR2044669",
                       taxa_col = "OTU",
                       abundance_col = "Abundance")
# All samples in a dataset
plot_ulrb_silhouette(classified_species,
          taxa_col = "OTU",
          abundance_col = "Abundance",
          plot_all = TRUE)

# All samples with a log scale
plot_ulrb_silhouette(classified_species,
          taxa_col = "OTU",
          abundance_col = "Abundance",
          plot_all = TRUE,
          log_scaled = TRUE)

</code></pre>


</div>