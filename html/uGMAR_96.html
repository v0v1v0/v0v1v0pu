<div class="container">

<table style="width: 100%;"><tr>
<td>stmar_to_gstmar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a G-StMAR model based on a StMAR model with large degrees of freedom parameters</h2>

<h3>Description</h3>

<p><code>stmar_to_gstmar</code> estimates a G-StMAR model based on a StMAR model with large degree
of freedom parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stmar_to_gstmar(
  gsmar,
  maxdf = 100,
  estimate,
  calc_std_errors,
  maxit = 100,
  custom_h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gsmar</code></td>
<td>
<p>a class 'gsmar' object, typically generated by <code>fitGSMAR</code> or <code>GSMAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdf</code></td>
<td>
<p>regimes with degrees of freedom parameter value larger than this will be turned into
GMAR type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>set <code>TRUE</code> if the new model should be estimated with a variable metric algorithm
using the StMAR model parameter value as the initial value. By default <code>TRUE</code> iff the model
contains data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_std_errors</code></td>
<td>
<p>set <code>TRUE</code> if the approximate standard errors should be calculated.
By default <code>TRUE</code> iff the model contains data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the maximum number of iterations for the variable metric algorithm. Ignored if <code>estimate==FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_h</code></td>
<td>
<p>A numeric vector with same the length as the parameter vector: i:th element of custom_h is the difference
used in central difference approximation for partial differentials of the log-likelihood function for the i:th parameter.
If <code>NULL</code> (default), then the difference used for differentiating overly large degrees of freedom parameters
is adjusted to avoid numerical problems, and the difference is <code>6e-6</code> for the other parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a StMAR model contains large estimates for the degrees of freedom parameters,
one should consider switching to the corresponding G-StMAR model that lets the corresponding
regimes to be GMAR type. <code>stmar_to_gstmar</code> does this switch conveniently.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'gsmar'</code> defining the specified GMAR, StMAR, or G-StMAR model. If data is supplied,
the returned object contains (by default) empirical mixing weights, some conditional and unconditional moments, and quantile
residuals. Note that the first p observations are taken as the initial values so the mixing weights, conditional moments, and
quantile residuals start from the p+1:th observation (interpreted as t=1).
</p>


<h3>References</h3>


<ul>
<li>
<p> Kalliovirta L., Meitz M. and Saikkonen P. 2015. Gaussian Mixture Autoregressive model for univariate time series.
<em>Journal of Time Series Analysis</em>, <strong>36</strong>(2), 247-266.
</p>
</li>
<li>
<p> Meitz M., Preve D., Saikkonen P. 2023. A mixture autoregressive model based on Student's t-distribution.
<em>Communications in Statistics - Theory and Methods</em>, <strong>52</strong>(2), 499-515.
</p>
</li>
<li>
<p> Virolainen S. 2022. A mixture autoregressive model based on Gaussian and Student's t-distributions.
Studies in Nonlinear Dynamics &amp; Econometrics, <strong>26</strong>(4) 559-580.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fitGSMAR</code>, <code>GSMAR</code>, <code>iterate_more</code>, <code>get_gradient</code>,
<code>get_regime_means</code>, <code>swap_parametrization</code>, <code>stmar_to_gstmar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # These are long running example that take approximately 15 seconds to run.
 fit42t &lt;- fitGSMAR(data=M10Y1Y, p=4, M=2, model="StMAR", ncalls=1, seeds=6)
 fit42t # Overly large degrees of freedom estimate!

 # Switch to the appropriate G-StMAR model:
 fit42gs &lt;- stmar_to_gstmar(fit42t)
 fit42gs

</code></pre>


</div>