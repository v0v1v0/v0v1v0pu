<div class="container">

<table style="width: 100%;"><tr>
<td>calc_gradient</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate gradient or Hessian matrix</h2>

<h3>Description</h3>

<p><code>calc_gradient</code> or <code>calc_hessian</code> calculates the gradient or Hessian matrix
of the given function at the given point using central difference numerical approximation.
<code>get_gradient</code> (and <code>get_foc</code>) or <code>get_hessian</code> calculates the gradient or Hessian matrix of the
log-likelihood function at the parameter values of a class <code>'gsmar'</code> object.
<code>get_soc</code> returns eigenvalues of the Hessian matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_gradient(x, fn, h = 6e-06, varying_h = NULL, ...)

calc_hessian(x, fn, h = 6e-06, varying_h = NULL, ...)

get_gradient(gsmar, custom_h = NULL)

get_foc(gsmar, custom_h = NULL)

get_hessian(gsmar, custom_h = NULL)

get_soc(gsmar, custom_h = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector specifying the point at which the gradient or Hessian should be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>a function that takes in the argument <code>x</code> as the <strong>first</strong> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the difference used to approximate the derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying_h</code></td>
<td>
<p>a numeric vector with the same length as <code>x</code> specifying the difference <code>h</code>
for each dimension separately. If <code>NULL</code> (default), then the difference given as parameter <code>h</code>
will be used for all dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>fn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsmar</code></td>
<td>
<p>a class 'gsmar' object, typically generated by <code>fitGSMAR</code> or <code>GSMAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_h</code></td>
<td>
<p>same as <code>varying_h</code> but if <code>NULL</code> (default), then the difference <code>h</code> used for differentiating
overly large degrees of freedom parameters is adjusted to avoid numerical problems, and the difference is <code>6e-6</code> for the other
parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In particular, the functions <code>get_foc</code> and <code>get_soc</code> can be used to check whether
the found estimates denote a (local) maximum point, a saddle point, or something else.
</p>


<h3>Value</h3>

<p>The gradient functions return numerical approximation of the gradient, and the Hessian functions return
numerical approximation of the Hessian. <code>get_soc</code> returns eigenvalues of the Hessian matrix, <code>get_foc</code>
is the same as <code>get_gradient</code> but named conveniently.
</p>


<h3>Warning</h3>

<p>No argument checks!
</p>


<h3>See Also</h3>

<p><code>profile_logliks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simple function
foo &lt;- function(x) x^2 + x
calc_gradient(x=1, fn=foo)
calc_gradient(x=-0.5, fn=foo)
calc_hessian(x=2, fn=foo)

# More complicated function
foo &lt;- function(x, a, b) a*x[1]^2 - b*x[2]^2
calc_gradient(x=c(1, 2), fn=foo, a=0.3, b=0.1)
calc_hessian(x=c(1, 2), fn=foo, a=0.3, b=0.1)

# GMAR model
params12 &lt;- c(1.70, 0.85, 0.30, 4.12, 0.73, 1.98, 0.63)
gmar12 &lt;- GSMAR(data=simudata, p=1, M=2, params=params12, model="GMAR")
get_gradient(gmar12)
get_foc(gmar12)
get_hessian(gmar12)
get_soc(gmar12)
</code></pre>


</div>