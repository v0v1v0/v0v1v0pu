<div class="container">

<table style="width: 100%;"><tr>
<td>upset_vp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualization of VPA and HP Using UpSetVP Diagram</h2>

<h3>Description</h3>

<p>Visualization of variance partitioning analysis (VPA) and hierarchical partitioning (HP) with unlimited number of predictor variables (or matrices of predictors) using UpSet matrix layout.
</p>


<h3>Usage</h3>

<pre><code class="language-R">upset_vp(
  x,
  plot.hp = TRUE,
  order.part = "effect",
  decreasing.part = TRUE,
  order.var = TRUE,
  decreasing.var = TRUE,
  cutoff = -1,
  nVar = 30,
  col.width = 0.6,
  pch.size = 3,
  line.lwd = 0.5,
  show.effect = TRUE,
  effect.cex = 2.7,
  title.cex = 10,
  axis.cex = 8,
  height.ratio = c(2, 1),
  width.ratio = c(1, 3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>rdacca.hp</code> object, which contains the output of VPA and HP from canonical analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.hp</code></td>
<td>
<p>The default is <code>TRUE</code>, which plots the individual effect for each predictor on left column diagram. If <code>FALSE</code>, compute and plot the sum of unique effect and common effect for each predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.part</code></td>
<td>
<p>How the VPA components in matrix layout should be ordered. Options include <code>"effect"</code> (order the intersections by their effects) or <code>"degree"</code> (sort by the number of predictors involved in the intersection), default is <code>"effect"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing.part</code></td>
<td>
<p>How the intersections in <code>order.part</code> should be ordered. Default is <code>TRUE</code>, <code>"effect"</code> is decreasing (from greatest to least) or <code>"degree"</code> is increasing (from least to greatest).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.var</code></td>
<td>
<p>The predictors in the matrix layout should be ordered by. Default is <code>TRUE</code>, which orders the predictors by their effects. IF <code>FALSE</code>, sort by the order of predictors in input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing.var</code></td>
<td>
<p>If <code>order.var=TRUE</code>, how the predictors should be ordered. Default is <code>TRUE</code>, from greatest to least.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Effects below <code>cutoff</code> will not be displayed, default is <code>-1</code>. Note: Negative effects due to adjustment of R-squared mean negligible contributions, but they are included in the computation of the total contribution of each predictor category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nVar</code></td>
<td>
<p>Number of components in VPA to plot, default is <code>30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.width</code></td>
<td>
<p>Width of bars in column diagram, default is <code>0.6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.size</code></td>
<td>
<p>Size of points in matrix diagram, default is <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>
<p>Width of lines in matrix diagram, default is <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.effect</code></td>
<td>
<p>Show the relative importance of predictors (unique, common, or individual effects) above bars, default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.cex</code></td>
<td>
<p>Font size of the effects, default is <code>2.7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.cex</code></td>
<td>
<p>Font size of axis titles, default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.cex</code></td>
<td>
<p>Font size of axis labels, default is <code>8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height.ratio</code></td>
<td>
<p>Ratio between matrix and top column diagram, default is <code>c(2, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.ratio</code></td>
<td>
<p>Ratio between matrix and left column diagram, default is <code>c(1, 3)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>UpSetVP diagram is an extension of UpSet technique (Conway et al. 2017; Lex et al. 2014) to canonical analysis and is used to visualize the object of <code>rdacca.hp</code> (Lai et al. 2022). The matrix layout enables the effective representation of relative importance of predictors, such as the unique effects and common effects in VPA, as well as additional summary statistics or individual effects in HP. UpSetVP diagram could, in principle, allow visualization of any number of predictor variables or groups of predictor variables. But considering the interpretability of data, we would like to recommend that the number of predictors (or groups of predictors) no more than 7.
</p>


<h3>Value</h3>

<p>Returns a ggplot2.
</p>


<h3>References</h3>

<p>Conway J R, Lex A, Gehlenborg N. UpSetR: an R package for the visualization of intersecting sets and their properties. Bioinformatics, 2017, 33(18): 2938-2940.
</p>
<p>Gong S, Feng B, Jian S P, et al. Elevation Matters More than Season in Shaping the Heterogeneity of Soil and Root Associated Ectomycorrhizal Fungal Community. Microbiology spectrum, 2022, 10(1): e01950-21.
</p>
<p>Lai J, Zou Y, Zhang J, et al. Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package. Methods in Ecology and Evolution, 2022.
</p>
<p>Lex A, Gehlenborg N, Strobelt H, et al. UpSet: visualization of intersecting sets. IEEE transactions on visualization and computer graphics, 2014, 20(12): 1983-1992.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(rdacca.hp)

## A simple example of partial dbRDA
data(baima.fun)
data(baima.env)

# Bray-Curtis index was used to calculate community composition dissimilarity
baima.fun.bray &lt;- vegdist(baima.fun, method = "bray")

# The relative importance of individual soil properties on EcM fungal community compositionon
soil &lt;- baima.env[c("pH", "TP", "TK", "AN", "AP", "AK")]
baima.soil.vp &lt;- rdacca.hp(baima.fun.bray, soil,
  method = "dbRDA", var.part = TRUE, type = "adjR2")

# Plot unique, common, as well as individual effects
upset_vp(baima.soil.vp, plot.hp = TRUE)

## Example was referenced from Gong et al. (2022)
if(requireNamespace("adespatial", quietly = TRUE)) {

# Distance-based Moran's eigenvector maps (dbMEM) was used to extract spatial relationships
space.dbmem &lt;- adespatial::dbmem(baima.env[c("latitude", "lontitude")])
  
  # The relative importance of groups of environmental factors on EcM fungal community composition
  env.list &lt;- list(
    elevation = baima.env["altitude"],
    season = baima.env["season"],
    space = data.frame(space.dbmem)[1:2],
    host = baima.env[c("em.GR", "em.abun")],
    climate = baima.env["sea.MT"],
    soil = baima.env[c("pH", "TP", "TK", "AN", "AP", "AK")]
  )
  baima.env.vp &lt;- rdacca.hp(baima.fun.bray, env.list,
    method = "dbRDA", var.part = TRUE, type = "adjR2")
  
  # Plot unique, common, as well as individual effects
  upset_vp(baima.env.vp, plot.hp = TRUE, order.part = "degree")
}

</code></pre>


</div>