<div class="container">

<table style="width: 100%;"><tr>
<td>power.ACE.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the power of an ACE model to detect paths of interest.</h2>

<h3>Description</h3>

<p><code>power.ACE.test</code> simulates a univariate ACE model. It
computes power to detect dropping one or more paths (a, c, or a after dropping c), specified in <code style="white-space: pre;">⁠drop=⁠</code>.
</p>
<p>The interface and functionality of this service are experimental and subject to change.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.ACE.test(
  AA = 0.5,
  CC = 0,
  EE = NULL,
  DD = NULL,
  update = c("a", "c", "a_after_dropping_c", "d"),
  value = 0,
  n = NULL,
  MZ_DZ_ratio = 1,
  sig.level = 0.05,
  power = 0.8,
  method = c("ncp", "empirical"),
  search = FALSE,
  tryHard = c("yes", "no", "ordinal", "search"),
  digits = 2,
  optimizer = NULL,
  nSim = 4000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>AA</code></td>
<td>
<p>Additive genetic variance (Default .5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CC</code></td>
<td>
<p>Shared environment variance (Default 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EE</code></td>
<td>
<p>Unique environment variance. Leave NULL (default) to compute an amount summing to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DD</code></td>
<td>
<p>Dominance Is set (default= NULL) compute an ADE rather than ACE model (DZr=.25)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>Component to drop (Default "a", i.e., drop a)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Value to set dropped path to (Default 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>If provided, solve at the given number of MZ+DZ pairs (Default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MZ_DZ_ratio</code></td>
<td>
<p>MZ pairs per DZ pair (Default 1 = equal numbers.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>alpha (p-value) Default = 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Default = .8 (80 percent power, equal to 1 - Type II rate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>How to estimate power: Default =  use non-centrality parameter ("ncp"). Alternative is "empirical"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search</code></td>
<td>
<p>Whether to return a search across power or just a point estimate (Default FALSE = point)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tryHard</code></td>
<td>
<p>Whether to tryHard to find a solution (default = "yes", alternatives are "no"...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Rounding for reporting parameters (default 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>If set, will switch the optimizer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSim</code></td>
<td>
<p>Total number of pairs to simulate in the models (default = 4000)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Statistical power is the proportion of studies that, over the long run, one should expect to yield a statistically
significant result given certain study characteristics such as sample size (N), the expected effect size (<code class="reqn">\beta</code>),
and the criterion for statistical significance (<code class="reqn">\alpha</code>).
</p>
<p>(with nMZpairs= 2000 and MZ_DZ_ratio*nMZpairs DZ twins.
</p>
<p>A typical target for power is 80%. Much as the accepted critical p-value is .05, this has emerged as a trade off, in this case
of resources required for more powerful studies against the cost of missing a true effect.  People interested in truth
discourage running studies with low power: A study with 20 percent power will fail to detect real effects 80% of the time.
But even with zero power, the Type-I error rate remains a nominal 5% (and with any researcher degrees of freedom, perhaps much more than that).
Low powered research, then, fails to detect true effects, and generates support for random false theories about as often.
This sounds silly, but empirical rates are often as low as 20% (Button, et al., 2013).
</p>
<p>Illustration of  <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, and power (1-<code class="reqn">\beta</code>):
</p>
<p><img src="../help/figures/power.png" width="50%" alt="Figure: power.png"></p>


<h3>Value</h3>

<p><code>OpenMx::mxPower()</code> object
</p>


<h3>References</h3>


<ul>
<li>
<p> Visscher, P.M., Gordon, S., Neale, M.C. (2008). Power of the classical twin design
revisited: II detection of common environmental variance. <em>Twin Res Hum Genet</em>, <strong>11</strong>: 48-54.
<a href="https://doi.org/10.1375/twin.11.1.48">doi:10.1375/twin.11.1.48</a>.
</p>
</li>
<li>
<p> Button, K. S., Ioannidis, J. P., Mokrysz, C., Nosek, B. A., Flint, J., Robinson, E. S., and Munafo, M. R. (2013).
Power failure: why small sample size undermines the reliability of neuroscience.
<em>Nature Reviews Neuroscience</em>, <strong>14</strong>, 365-376. <a href="https://doi.org/10.1038/nrn3475">doi:10.1038/nrn3475</a>
</p>
</li>
</ul>
<h3>See Also</h3>


<ul><li> <p><code>umxPower()</code>, <code>OpenMx::mxPower()</code>, <code>umxACE()</code>
</p>
</li></ul>
<p>Other Twin Modeling Functions: 
<code>umxACEcov()</code>,
<code>umxACEv()</code>,
<code>umxACE()</code>,
<code>umxCP()</code>,
<code>umxDiffMZ()</code>,
<code>umxDiscTwin()</code>,
<code>umxDoCp()</code>,
<code>umxDoC()</code>,
<code>umxGxE_window()</code>,
<code>umxGxEbiv()</code>,
<code>umxGxE()</code>,
<code>umxIP()</code>,
<code>umxMRDoC()</code>,
<code>umxReduceACE()</code>,
<code>umxReduceGxE()</code>,
<code>umxReduce()</code>,
<code>umxRotate.MxModelCP()</code>,
<code>umxSexLim()</code>,
<code>umxSimplex()</code>,
<code>umxSummarizeTwinData()</code>,
<code>umxSummaryACEv()</code>,
<code>umxSummaryACE()</code>,
<code>umxSummaryDoC()</code>,
<code>umxSummaryGxEbiv()</code>,
<code>umxSummarySexLim()</code>,
<code>umxSummarySimplex()</code>,
<code>umxTwinMaker()</code>,
<code>umx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# =====================================================
# = N for .8 power to detect a^2 = .5 equal MZ and DZ =
# =====================================================
power.ACE.test(AA = .5, CC = 0, update = "a")
# Suggests n = 84 MZ and 94 DZ pairs.

## Not run: 
# ================================
# = Show power across range of N =
# ================================
power.ACE.test(AA= .5, CC= 0, update = "a", search = TRUE)

# Salutary note: You need well fitting models with correct betas in the data
# for power to be valid.
# tryHard helps ensure this, as does the default nSim= 4000 pair data.
# Power is important to get right, so I recommend using tryHard = "yes" (the default)

# =====================
# = Power to detect C =
# =====================

# 102 of each of MZ and DZ pairs for 80% power (default).
power.ACE.test(AA= .5, CC= .3, update = "c")

# ==========================================
# = Set 'a' to a fixed, but non-zero value =
# ==========================================

power.ACE.test(update= "a", value= sqrt(.2), AA= .5, CC= 0)

# ========================================
# = Drop More than one parameter (A &amp; C) =
# ========================================
# E vs AE: the hypothesis that twins show no familial similarity.
power.ACE.test(update = "a_after_dropping_c", AA= .5, CC= .3)

# ===================================================
# = More power to detect A &gt; 0 when more C present  =
# ===================================================

power.ACE.test(update = "a", AA= .5, CC= .0)
power.ACE.test(update = "a", AA= .5, CC= .3)

# ====================================================
# = More power to detect C &gt; 0 when more A present?  =
# ====================================================

power.ACE.test(update = "c", AA= .0, CC= .5)
power.ACE.test(update = "c", AA= .3, CC= .5)


# ===================================
# = Power with more DZs or more MZs =
# ===================================

# Power about the same: total pairs with 2 MZs per DZ
power.ACE.test(MZ_DZ_ratio= 2/1, update= "a", AA= .3, CC= 0, method="ncp", tryHard="yes")
power.ACE.test(MZ_DZ_ratio= 1/2, update= "a", AA= .3, CC= 0, method="ncp", tryHard="yes")
power.ACE.test(update= "a", AA= .3, CC= 0, method="ncp", tryHard="yes")


# =====================================
# = Compare ncp and empirical methods =
# =====================================

power.ACE.test(update= "a", AA= .5, CC= 0, method = "ncp")
# method = "ncp": For 80% power, you need 166 MZ and 166 DZ pairs
power.ACE.test(update= "a", AA= .5, CC= 0, method= "empirical")
# method= "empirical": For 80% power, you need 154 MZ and 154 DZ pairs

# ====================
# = Show off options =
# ====================
# 1. tryHard

power.ACE.test(update = "a", AA= .5, CC= 0, tryHard= "no")

# 2. toggle optimizer

power.ACE.test(update= "a", AA= .5, CC= 0, optimizer= "SLSQP")

# 3. You can raise or lower the number of pairs used in the true model
#    by varying nSim (twin pairs in the simulated data).

power.ACE.test(update = "a", AA= .5, CC= 0, nSim= 20)


## End(Not run)

</code></pre>


</div>