<div class="container">

<table style="width: 100%;"><tr>
<td>umxGxEbiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Purcell (2002) Bivariate GxE model: Suitable when twins differ on the moderator.</h2>

<h3>Description</h3>

<p>GxE interaction models test the hypothesis that the strength of genetic
and environmental influences vary parametrically across levels of a measured environment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">umxGxEbiv(
  name = "GxEbiv",
  selDVs,
  selDefs,
  dzData,
  mzData,
  sep = NULL,
  lboundACE = 0,
  lboundM = NA,
  dropMissingDef = FALSE,
  autoRun = getOption("umx_auto_run"),
  tryHard = c("no", "yes", "ordinal", "search"),
  optimizer = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the model (defaults to "GxEbiv")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selDVs</code></td>
<td>
<p>The dependent variable (e.g. IQ)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selDefs</code></td>
<td>
<p>The definition variable (e.g. socioeconomic status)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzData</code></td>
<td>
<p>The DZ dataframe containing the Twin 1 and Twin 2 DV and moderator (4 columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mzData</code></td>
<td>
<p>The MZ dataframe containing the Twin 1 and Twin 2 DV and moderator (4 columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>Expand variable base names, i.e., "_T" makes var -&gt; var_T1 and var_T2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lboundACE</code></td>
<td>
<p>If !NA, then lbound the main effects at this value (default = NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lboundM</code></td>
<td>
<p>If !NA, then lbound the moderators at this value (default = NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropMissingDef</code></td>
<td>
<p>Whether to automatically drop missing def var rows for the user (gives a warning) default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoRun</code></td>
<td>
<p>Whether to run the model (default), or just to create it and return without running.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tryHard</code></td>
<td>
<p>Default ('no') uses normal mxRun. "yes" uses mxTryHard. Other options: "ordinal", "search"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>Optionally set the optimizer (default NULL does nothing)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Whereas univariate <code>umxGxE()</code> models assume the twins share the moderator,
or have zero correlation on the moderator, <code>umxGxEbiv()</code> allows testing moderation in
cases where members of a twin pair differ on the moderator, (Purcell, 2002; van der Sluis et al., 2012).
</p>
<p>This is the same model we teach at Boulder.
</p>
<p>The following figure shows this bivariate GxE model as a path diagram (Twin 1 shown). Whereas
the univariate model incorporates the moderator in the means model, the bivariate model incorporates
the moderator as a first class variable, with its own ACE structure, shared pathways to the trait of interest,
and the ability to moderate both specific and shared A, C, and E, influences on the trait of interest.
</p>
<p><img src="../help/figures/GxEbiv.png" alt="GxEbiv.png"></p>
<p>Twin 1 and twin 2 A, C, and E latent traits are connected in the standard fashion, with the
covariance of the T1 and T2 latent genetic traits set to .5 for DZ and 1.0 for MZ pairs.
For the sake of clarity, C, and E paths are omitted here. These mirror those for A.
</p>


<h3>Value</h3>


<ul><li>
<p> GxEbiv <code>mxModel()</code>
</p>
</li></ul>
<h3>References</h3>


<ul>
<li>
<p> Purcell, S. (2002). Variance components models for gene-environment interaction in twin analysis. <em>Twin Research</em>,
<strong>6</strong>, 554-571. <a href="https://doi.org/10.1375/twin.5.6.554">doi:10.1375/twin.5.6.554</a>.
</p>
</li>
<li>
<p> van der Sluis, S., Posthuma, D., &amp; Dolan, C. V. (2012). A note on false positives and
power in G x E modelling of twin data. <em>Behavior Genetics</em>,
<strong>42</strong>, 170-186. <a href="https://doi.org/10.1007/s10519-011-9480-3">doi:10.1007/s10519-011-9480-3</a>.
</p>
</li>
</ul>
<h3>See Also</h3>


<ul><li> <p><code>plot()</code>, <code>umxSummary()</code>, <code>umxReduce()</code>
</p>
</li></ul>
<p>Other Twin Modeling Functions: 
<code>power.ACE.test()</code>,
<code>umxACEcov()</code>,
<code>umxACEv()</code>,
<code>umxACE()</code>,
<code>umxCP()</code>,
<code>umxDiffMZ()</code>,
<code>umxDiscTwin()</code>,
<code>umxDoCp()</code>,
<code>umxDoC()</code>,
<code>umxGxE_window()</code>,
<code>umxGxE()</code>,
<code>umxIP()</code>,
<code>umxMRDoC()</code>,
<code>umxReduceACE()</code>,
<code>umxReduceGxE()</code>,
<code>umxReduce()</code>,
<code>umxRotate.MxModelCP()</code>,
<code>umxSexLim()</code>,
<code>umxSimplex()</code>,
<code>umxSummarizeTwinData()</code>,
<code>umxSummaryACEv()</code>,
<code>umxSummaryACE()</code>,
<code>umxSummaryDoC()</code>,
<code>umxSummaryGxEbiv()</code>,
<code>umxSummarySexLim()</code>,
<code>umxSummarySimplex()</code>,
<code>umxTwinMaker()</code>,
<code>umx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(umx)
data(twinData)
selDVs  = "wt"
selDefs = "ht"
df = umx_scale_wide_twin_data(twinData, varsToScale = c("ht", "wt"), sep = "")
mzData  = subset(df, zygosity %in%  c("MZFF", "MZMM"))
dzData  = subset(df, zygosity %in%  c("DZFF", "DZMM", "DZOS"))

## Not run: 
m1 = umxGxEbiv(selDVs = selDVs, selDefs = selDefs, 
	dzData = dzData, mzData = mzData, sep = "", dropMissingDef = TRUE)

# Plot Moderation
umxSummaryGxEbiv(m1)
umxSummary(m1, location = "topright")
umxSummary(m1, separateGraphs = FALSE)
m2 = umxModify(m1, update = c("cBeta2_r1c1", "eBeta1_r1c1", "eBeta2_r1c1"), comparison = TRUE)

# TODO: teach umxReduce to test all relevant hypotheses for umxGxEbiv
umxReduce(m1)

## End(Not run)
</code></pre>


</div>