<div class="container">

<table style="width: 100%;"><tr>
<td>umxDoC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build and run a 2-group Direction of Causation twin models.</h2>

<h3>Description</h3>

<p>Testing causal claims is often difficult due to an inability to conduct experimental randomization of traits and
situations to people. When twins are available, even when measured on a single occasion, the pattern of cross-twin
cross-trait correlations can (given distinguishable modes of inheritance for the two traits) falsify causal hypotheses.
</p>
<p><code>umxDoC</code> implements a 2-group model to form latent variables for each of two traits, and allows testing whether
trait 1 causes trait 2, vice-versa, or even reciprocal causation.
</p>
<p>Using latent variables instead of a manifest measure for testing causation, avoids the bias created by differences in
measurement error in which the more reliable measure appears to "cause" the less reliable one (Gillespie and Martin, 2005).
</p>
<p>The following figure shows how the DoC model appears as a path diagram (for two latent variables X and Y,
each with three indicators). Note: For pedagogical reasons, only the model for 1 twin is shown, and only one DoC pathway drawn.
</p>
<p><img src="../help/figures/DoC.png" width="50%" alt="Figure: Direction of Causation"></p>


<h3>Usage</h3>

<pre><code class="language-R">umxDoC(
  name = "DoC",
  var1Indicators,
  var2Indicators,
  mzData = NULL,
  dzData = NULL,
  sep = "_T",
  causal = TRUE,
  autoRun = getOption("umx_auto_run"),
  intervals = FALSE,
  tryHard = c("no", "yes", "ordinal", "search"),
  optimizer = NULL,
  data = NULL,
  zyg = "zygosity"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the model (defaults to "DOC").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var1Indicators</code></td>
<td>
<p>variables defining latent trait 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var2Indicators</code></td>
<td>
<p>variables defining latent trait 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mzData</code></td>
<td>
<p>The MZ dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dzData</code></td>
<td>
<p>The DZ dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The separator in twin variable names, default = "_T", e.g. "dep_T1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causal</code></td>
<td>
<p>whether to add the causal paths (default TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoRun</code></td>
<td>
<p>Whether to run the model (default), or just to create it and return without running.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>Whether to run mxCI confidence intervals (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tryHard</code></td>
<td>
<p>Default ('no') uses normal mxRun. "yes" uses mxTryHard. Other options: "ordinal", "search"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>Optionally set the optimizer (default NULL does nothing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>= NULL If building the MZ and DZ datasets internally from a complete data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zyg</code></td>
<td>
<p>= "zygosity" (for the data= method of using this function)</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul><li> <p><code>mxModel()</code> of subclass MxModelDoC
</p>
</li></ul>
<h3>References</h3>


<ul><li>
<p> N.A. Gillespie and N.G. Martin (2005). Direction of Causation Models. In <em>Encyclopedia of Statistics in Behavioral Science</em>, <strong>1</strong>. 496â€“499. Eds. Brian S. Everitt &amp; David C. Howell.
</p>
</li></ul>
<ul>
<li>
<p> McGue, M., Osler, M., &amp; Christensen, K. (2010). Causal Inference and Observational Research: The Utility of Twins. <em>Perspectives on Psychological Science</em>, <strong>5</strong>, 546-556. <a href="https://doi.org/10.1177/1745691610383511">doi:10.1177/1745691610383511</a>
</p>
</li>
<li>
<p> Rasmussen, S. H. R., Ludeke, S., &amp; Hjelmborg, J. V. B. (2019). A major limitation of the direction of causation model: non-shared environmental confounding. <em>Twin Res Hum Genet</em>, <strong>22</strong>, 1-13. <a href="https://doi.org/10.1017/thg.2018.67">doi:10.1017/thg.2018.67</a>
</p>
</li>
</ul>
<h3>See Also</h3>


<ul><li> <p><code>umxDiscTwin()</code>
</p>
</li></ul>
<p>Other Twin Modeling Functions: 
<code>power.ACE.test()</code>,
<code>umxACEcov()</code>,
<code>umxACEv()</code>,
<code>umxACE()</code>,
<code>umxCP()</code>,
<code>umxDiffMZ()</code>,
<code>umxDiscTwin()</code>,
<code>umxDoCp()</code>,
<code>umxGxE_window()</code>,
<code>umxGxEbiv()</code>,
<code>umxGxE()</code>,
<code>umxIP()</code>,
<code>umxMRDoC()</code>,
<code>umxReduceACE()</code>,
<code>umxReduceGxE()</code>,
<code>umxReduce()</code>,
<code>umxRotate.MxModelCP()</code>,
<code>umxSexLim()</code>,
<code>umxSimplex()</code>,
<code>umxSummarizeTwinData()</code>,
<code>umxSummaryACEv()</code>,
<code>umxSummaryACE()</code>,
<code>umxSummaryDoC()</code>,
<code>umxSummaryGxEbiv()</code>,
<code>umxSummarySexLim()</code>,
<code>umxSummarySimplex()</code>,
<code>umxTwinMaker()</code>,
<code>umx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# ========================
# = Does Rain cause Mud? =
# ========================

# ================
# = 1. Load Data =
# ================
data(docData)
docData = umx_scale_wide_twin_data(c(var1, var2), docData, sep= "_T")
mzData  = subset(docData, zygosity %in% c("MZFF", "MZMM"))
dzData  = subset(docData, zygosity %in% c("DZFF", "DZMM"))

# =======================================
# = 2. Define manifests for var 1 and 2 =
# =======================================
var1 = paste0("varA", 1:3)
var2 = paste0("varB", 1:3)

# =======================================================
# = 3. Make the non-causal (Cholesky) and causal models =
# =======================================================
Chol = umxDoC(var1= var1, var2= var2, mzData= mzData, dzData= dzData, causal= FALSE)
# nb: DoC initially has causal paths fixed @0
DoC  = umxDoC(var1= var1, var2= var2, mzData= mzData, dzData= dzData, causal= TRUE)
a2b   = umxModify(DoC, "a2b", free = TRUE, name = "a2b"); summary(a2b)
b2a   = umxModify(DoC, "b2a", free = TRUE, name = "b2a"); summary(b2a)
Recip = umxModify(DoC, c("a2b", "b2a"), free = TRUE, name = "Recip"); summary(Recip)

# Compare fits
umxCompare(Chol, c(a2b, b2a, Recip))

# ==========================================
# = Alternative call with data in one file =
# ==========================================
data(docData)
docData = umx_scale_wide_twin_data(c(var1, var2), docData, sep= "_T")
DoC = umxDoC(var1= paste0("varA", 1:3), var2= paste0("varB", 1:3),
	  mzData= c("MZFF", "MZMM"), dzData= c("DZFF", "DZMM"), data = docData
)

## End(Not run)
</code></pre>


</div>