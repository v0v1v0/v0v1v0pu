<div class="container">

<table style="width: 100%;"><tr>
<td>chunk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Get indices for partial image reading/writing
</h2>

<h3>Description</h3>

<p>In the case of 'Cannot allocate vector of size ...' error message <code>chunk_band</code> returns list of bands indices, which are suitable for allocation in memory at once, <code>chunk_line</code> returns list of lines (rows) indices, which are suitable for allocation in memory at once. <code>chunk_expand</code> is used to expand lines indices and can by applied in focal functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chunk_band(obj, mem = 100, mul = 1)
chunk_line(obj, mem = 100, mul = 1)
chunk_expand(ind, size = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>

<p>Object of class <code>ursaRaster</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mem</code></td>
<td>

<p>Numeric. Memory size in GB, which is suitable for allocation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mul</code></td>
<td>

<p>Numeric. Expansion or reduction factor (multiplier) of default value of memory allocation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>

<p>Integer. Line indices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>Integer. Size of focal window.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>chunk_band</code> returns list with sequences of bands
</p>
<p><code>chunk_line</code> returns list with sequences of lines
</p>
<p><code>chunk_expand</code> returns list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>src</code></td>
<td>
<p>expanded set if line indices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dst</code></td>
<td>
<p>matching of source indices in the expanded set</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nikita Platonov <a href="mailto:platonov@sevin.ru">platonov@sevin.ru</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## 1. Prepare data
 session_grid(NULL)
 fname &lt;- ursa:::.maketmp(2)
 a &lt;- create_envi(fname[1],nband=3,ignorevalue=-99)
 for (i in seq(nband(a)))
   a[i] &lt;- pixelsize()^(1/i)
 close(a)
 rm(a)
 
 ## 2. Read 
 a &lt;- open_envi(fname[1])
 chB &lt;- chunk_band(a,2)
 str(chB)
 for (i in chB)
    print(a[i])
 chL &lt;- chunk_line(a,2.5)
 str(chL)
 for (j in chL)
    print(a[,j])
 
 ## 3. Filtering with partial reading
 b &lt;- create_envi(a,fname[2])
 fsize &lt;- 15
 for (j in chL) {
    k &lt;- chunk_expand(j,fsize)
    b[,j] &lt;- focal_mean(a[,k$src],size=fsize)[,k$dst]
 }
 d1 &lt;- b[]
 
 ##  4. Filtering in memory
 d2 &lt;- focal_mean(a[],size=fsize)
 close(a,b)
 envi_remove(fname)
 print(d1-d2)
 print(round(d1-d2,4))
</code></pre>


</div>