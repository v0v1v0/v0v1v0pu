<div class="container">

<table style="width: 100%;"><tr>
<td>AMextract</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Annual maximum extraction</h2>

<h3>Description</h3>

<p>Extracts the annual maximum peaks (with other options) from a data.frame which has dates (or POSIXct) in the first column and variable in the second.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AMextract(
  x,
  func = NULL,
  Calendar = FALSE,
  Trunc = TRUE,
  Plot = TRUE,
  Title = "Hydrological annual maximum sequence",
  Ylabel = "Magnitude"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data.frame with dates (or POSIXct) in the first column and variable in the second</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>A user chosen function to extract statistics other than maximums.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Calendar</code></td>
<td>
<p>logical. If FALSE, the hydrological year maximums are returned. If TRUE, the calendar year maximums are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trunc</code></td>
<td>
<p>logical with a default of TRUE. When true the beginning and end of the data.frame are first truncated so that it starts and ends at the start and end of the hydrological year (or Calendar year if Calendar = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plot</code></td>
<td>
<p>a logical argument with a default of TRUE. If TRUE the extracted annual maximum is plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Title</code></td>
<td>
<p>Title of the plot when. Default is "Hydrological annual maximum sequence"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ylabel</code></td>
<td>
<p>Label for the y axis. Default is "Annual maximum quantiles"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The peaks are extracted based on the UK hydrological year (unless Calendar = TRUE), which starts October 1st and ends September 30th. If Trunc = TRUE, partial years (non-full years from the beginning and end) are removed, otherwise the maximum value may not be the true annual maximum of the year. If there are NAs for full years in the data, an -Inf or NA will be returned for that year. The default is to extract maximums but the user can use the func argument to choose other statistics (mean or sum for example). Note that if the data has a sub-daily resolution, it is first aggregated to a daily resolution (with a 09:00 start) before the extraction. For example, the maximum for each day is extracted, then the annual maximums are extracted.
</p>


<h3>Value</h3>

<p>a data.frame with columns; WaterYear and AM. By default AM is the annual maximum sample, but will be any statistic used as the func argument.
</p>


<h3>Author(s)</h3>

<p>Anthony Hammond
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Extract the Thames AMAX daily mean flow and display the first six rows
ThamesAM &lt;- AMextract(ThamesPQ[,c(1,3)])
head(ThamesAM)
#Extract the annual rainfall totals and change the plot labels accordingly
ThamesAnnualP &lt;- AMextract(ThamesPQ[,1:2], func = sum, Title = "", Ylab = "Rainfall (mm)")
</code></pre>


</div>